
TEST_CASES = [
    {
        'file': '../../resources/sample_nmap_results_1.txt',
        'port_counts': {
            22: 1,
            25: 1,
            80: 1,
            9929: 1,
            31337: 1,
            3306: 0
        },
        'os_info': {
            'Linux 2.6': 1,
            'Windows': 0
        },
        'ips': {
            '45.33.32.156': 1,
            '127.0.0.1': 0
        },
        'hostnames': {
            'scanme.nmap.org': 1,
            'fake.com': 0
        }
    },
    {
        'file': '../../resources/sample_nmap_results_2.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_3.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_4.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_5.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_6.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_7.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_8.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_9.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_10.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_11.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_12.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_13.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_14.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_15.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_16.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_17.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_18.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_19.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_20.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_21.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_22.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_23.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/sample_nmap_results_24.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_ftp_anon_vuln_scan_results.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_http_vuln_cve2011-3192_results.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_smb_enumeration.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_smb_os_discovery.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_smb_security_mode_scan.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/nmap_smb_vulns.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/ping_sweep_1.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/ping_sweep_2.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/ping_sweep_3.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
    {
        'file': '../../resources/ping_sweep_4.txt',
        'port_counts': {

        },
        'os_info': {

        },
        'ips': {

        },
        'hostnames': {

        }
    },
]
# TODO: Check result to validate output
    

# TODO: Find a way to test interactive query mode

# TODO: Add negative integration test cases (invalid input files; non-existent and empty files)

# TODO: Make sure to test all possible flag combinations
def execute_script(options):
    return subprocess.run(['../nmap_query.py'] + options, stdout=subprocess.PIPE).stdout.decode('utf-8')


def run_script_integration_tests():
    pass

def run_core_integration_tests():
    print("Starting integration tests...")

    for test_case in TEST_CASES:
        pass
        # TODO: Implement

def run_integration_tests():
    run_script_integration_tests()
    run_core_integration_tests()
